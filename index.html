<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<title>Studio de Desenho</title>
<style>
  :root{
    --bg: #f8fafc;
    --panel: #ffffff;
    --muted: #64748b;
    --accent: #2563eb;
    --danger: #dc2626;
    --surface-shadow: 0 6px 18px rgba(2,6,23,0.06);
  }
  html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;}
  body{background:linear-gradient(180deg,var(--bg),#fff);display:flex;align-items:center;justify-content:center;padding:12px;}
  .app{width:100%;max-width:1200px;background:var(--panel);border-radius:14px;box-shadow:var(--surface-shadow);overflow:hidden;display:flex;flex-direction:column;height:100%}
  header{display:flex;flex-direction:column;gap:6px;align-items:flex-start;justify-content:center;padding:12px 16px;border-bottom:1px solid #eef2f7}
  header h1{margin:0;font-size:18px}
  header p{margin:0;color:var(--muted);font-size:13px}
  .controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin-top:6px}
  button, .btn{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:8px;border:0;background:#eef2ff;color:#003;cursor:pointer;font-size:14px}
  .btn.secondary{background:#f1f5f9}
  .btn.danger{background:var(--danger);color:white}
  .panel{flex:1;display:flex;flex-direction:row;gap:16px;padding:12px;overflow:hidden}
  .tools{min-width:260px;max-width:300px;overflow-y:auto;padding:10px;display:flex;flex-direction:column;gap:12px}
  .tools h3{margin:0;font-size:14px}
  .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  input[type=color]{width:44px;height:36px;padding:0;border:0;background:none;cursor:pointer}
  input[type=range]{width:100%}
  .preset-colors{display:flex;gap:8px;flex-wrap:wrap}
  .swatch{width:28px;height:28px;border-radius:6px;border:1px solid rgba(0,0,0,0.06);cursor:pointer}
  .canvas-wrap{background:#fff;border-radius:10px;border:1px solid #e6eef6;overflow:hidden;position:relative;flex:1}
  canvas{position:absolute;inset:0;display:block;width:100%;height:100%;touch-action:none;cursor:crosshair}
  .status{padding:8px 12px;border-top:1px solid #eef2f7;font-size:13px;color:var(--muted);display:flex;justify-content:space-between;align-items:center}
  .kbd{background:#111827;color:#fff;padding:2px 6px;border-radius:6px;font-size:12px}
  /* mobile responsiveness */
  @media (max-width:768px){
    .panel{flex-direction:column}
    .tools{order:2;min-width:100%;max-height:40%;flex:0 0 auto}
    .canvas-wrap{order:1;flex:1;min-height:60vh}
    header{align-items:flex-start}
  }
</style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Studio de Desenho</h1>
      <p>Use pincel ou borracha, escolha cor, mude espessura e salve seu desenho.</p>
      <div class="controls">
        <button id="saveBtn" class="btn">ðŸ’¾ Salvar PNG</button>
        <button id="undoBtn" class="btn secondary">â†¶ Desfazer</button>
        <button id="redoBtn" class="btn secondary">â†· Refazer</button>
        <button id="clearBtn" class="btn danger">ðŸ—‘ Limpar</button>
      </div>
    </header>

    <div class="panel">
      <div class="canvas-wrap" id="canvasWrap">
        <canvas id="gridCanvas"></canvas>
        <canvas id="drawCanvas"></canvas>
      </div>

      <aside class="tools">
        <h3>Ferramentas</h3>
        <div class="row">
          <button id="brushBtn" class="btn" aria-pressed="true">ðŸ–Œ Pincel</button>
          <button id="eraserBtn" class="btn secondary">ðŸ©¹ Borracha</button>
        </div>

        <label>Cor:</label>
        <div class="row">
          <input id="colorPicker" type="color" value="#111827" />
          <input id="colorHex" type="text" value="#111827" style="flex:1;padding:6px;border-radius:6px;border:1px solid #eef2f7" />
        </div>
        <div class="preset-colors">
          <button class="swatch" data-color="#111827" style="background:#111827"></button>
          <button class="swatch" data-color="#ef4444" style="background:#ef4444"></button>
          <button class="swatch" data-color="#3b82f6" style="background:#3b82f6"></button>
          <button class="swatch" data-color="#10b981" style="background:#10b981"></button>
        </div>

        <label>Espessura: <strong id="sizeLabel">8</strong>px</label>
        <input id="sizeRange" type="range" min="1" max="60" value="8" />

        <label><input id="gridToggle" type="checkbox" /> Mostrar grade</label>

        <label>Importar imagem</label>
        <input id="fileInput" type="file" accept="image/*" />

        <small style="color:var(--muted)">Atalhos: <span class="kbd">Ctrl+Z</span> / <span class="kbd">Ctrl+Y</span> / <span class="kbd">Ctrl+S</span></small>
      </aside>
    </div>
    <div class="status"><span id="statusText">Pronto</span><span>Ferramenta: <span id="toolName">Pincel</span></span></div>
  </div>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5781002268712149"
     crossorigin="anonymous">
/* ====== VariÃ¡veis ====== */
const gridCanvas = document.getElementById('gridCanvas');
const drawCanvas = document.getElementById('drawCanvas');
const canvasWrap = document.getElementById('canvasWrap');
const gctx = gridCanvas.getContext('2d');
const ctx = drawCanvas.getContext('2d');

let dpr = Math.max(1, window.devicePixelRatio || 1);
let tool = 'brush';
let color = '#111827';
let size = 8;
let drawing = false;
let last = { x: 0, y: 0 };
const history = [];
let historyIndex = -1;

/* ====== FunÃ§Ãµes ====== */
function resizeCanvases() {
  const rect = canvasWrap.getBoundingClientRect();
  const w = rect.width;
  const h = rect.height;
  dpr = window.devicePixelRatio || 1;
  [gridCanvas, drawCanvas].forEach(c => {
    c.width = w * dpr;
    c.height = h * dpr;
    c.style.width = w + 'px';
    c.style.height = h + 'px';
    c.getContext('2d').setTransform(dpr,0,0,dpr,0,0);
  });
  drawGrid();
}
function getPos(e){
  const rect = drawCanvas.getBoundingClientRect();
  if(e.touches) e = e.touches[0];
  return {x: e.clientX-rect.left, y: e.clientY-rect.top};
}
function startDraw(e){drawing=true;const p=getPos(e);last=p;ctx.beginPath();ctx.moveTo(p.x,p.y);}
function draw(e){if(!drawing)return;const p=getPos(e);ctx.globalCompositeOperation=tool==='eraser'?'destination-out':'source-over';ctx.strokeStyle=color;ctx.lineWidth=size;ctx.lineCap='round';ctx.lineTo(p.x,p.y);ctx.stroke();last=p;}
function endDraw(){if(!drawing)return;drawing=false;ctx.closePath();saveHistory();}
function saveHistory(){try{const data=drawCanvas.toDataURL();history.splice(historyIndex+1);history.push(data);if(history.length>50)history.shift();historyIndex=history.length-1;}catch{}}
function restore(i){const img=new Image();img.onload=()=>{ctx.clearRect(0,0,drawCanvas.width,drawCanvas.height);ctx.drawImage(img,0,0,drawCanvas.width/dpr,drawCanvas.height/dpr)};img.src=history[i];}
function undo(){if(historyIndex>0){historyIndex--;restore(historyIndex);}}
function redo(){if(historyIndex<history.length-1){historyIndex++;restore(historyIndex);}}
function drawGrid(){gctx.clearRect(0,0,gridCanvas.width,gridCanvas.height);if(!gridToggle.checked)return;gctx.strokeStyle='rgba(0,0,0,0.08)';for(let x=0;x<gridCanvas.width/dpr;x+=20){gctx.beginPath();gctx.moveTo(x,0);gctx.lineTo(x,gridCanvas.height/dpr);gctx.stroke();}for(let y=0;y<gridCanvas.height/dpr;y+=20){gctx.beginPath();gctx.moveTo(0,y);gctx.lineTo(gridCanvas.width/dpr,y);gctx.stroke();}}
function clearCanvas(){ctx.clearRect(0,0,drawCanvas.width,drawCanvas.height);saveHistory();}
function savePNG(){const link=document.createElement('a');link.download='desenho.png';link.href=drawCanvas.toDataURL();link.click();}
function importImage(file){const r=new FileReader();r.onload=()=>{const img=new Image();img.onload=()=>{ctx.drawImage(img,0,0,drawCanvas.width/dpr,drawCanvas.height/dpr);saveHistory();};img.src=r.result;};r.readAsDataURL(file);}

/* ====== Controles ====== */
brushBtn.onclick=()=>{tool='brush';toolName.textContent='Pincel';};
eraserBtn.onclick=()=>{tool='eraser';toolName.textContent='Borracha';};
colorPicker.oninput=e=>{color=e.target.value;colorHex.value=color;};
colorHex.onchange=e=>{color=e.target.value;};
sizeRange.oninput=e=>{size=parseInt(e.target.value);sizeLabel.textContent=size;};
gridToggle.onchange=drawGrid;
saveBtn.onclick=savePNG;
undoBtn.onclick=undo;
redoBtn.onclick=redo;
clearBtn.onclick=clearCanvas;
fileInput.onchange=e=>{if(e.target.files[0])importImage(e.target.files[0]);};
document.querySelectorAll('.swatch').forEach(s=>s.onclick=()=>{color=s.dataset.color;colorPicker.value=color;colorHex.value=color;});

/* ====== Eventos ====== */
drawCanvas.addEventListener('mousedown',startDraw);
drawCanvas.addEventListener('mousemove',draw);
window.addEventListener('mouseup',endDraw);
drawCanvas.addEventListener('touchstart',startDraw,{passive:false});
drawCanvas.addEventListener('touchmove',draw,{passive:false});
window.addEventListener('touchend',endDraw);
window.addEventListener('resize',resizeCanvases);

/* ====== Atalhos ====== */
window.addEventListener('keydown',e=>{
  const ctrl=e.ctrlKey||e.metaKey;
  if(ctrl&&e.key==='z'){e.preventDefault();undo();}
  if(ctrl&&e.key==='y'){e.preventDefault();redo();}
  if(ctrl&&e.key==='s'){e.preventDefault();savePNG();}
});

/* ====== Inicial ====== */
resizeCanvases();
saveHistory();
</script>
</body>
</html>
